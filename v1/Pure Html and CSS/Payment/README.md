# اتصال صفحه خرید به درگاه پرداخت

## نحوه عملکرد

### 1. مسیر خرید:
```
صفحه اصلی (Index) → صفحه خرید (Shopping) → درگاه پرداخت (Payment)
```

### 2. انتقال داده‌ها:
- **Session Storage**: برای انتقال اطلاعات سفارش از Shopping به Payment
- **Key**: `orderData` 
- **Structure**:
```json
{
  "items": [محصولات انتخاب شده],
  "totalPrice": مجموع قیمت,
  "discount": تخفیف,
  "finalTotal": مبلغ نهایی,
  "orderDate": تاریخ سفارش,
  "userId": شناسه کاربر
}
```

### 3. ویژگی‌های کلیدی:

#### در صفحه Shopping:
- ✅ محاسبه خودکار قیمت کل
- ✅ اعمال تخفیف 5%
- ✅ ذخیره اطلاعات سفارش
- ✅ انتقال به صفحه پرداخت

#### در صفحه Payment:
- ✅ بارگذاری اطلاعات سفارش
- ✅ نمایش محصولات انتخاب شده
- ✅ محاسبه مجدد مبالغ
- ✅ به‌روزرسانی قیمت در دکمه پرداخت
- ✅ مدیریت بازگشت به صفحه خرید

### 4. امنیت و خطایابی:
- **بررسی وجود داده**: اگر orderData موجود نباشد، بازگشت به Shopping
- **پاکسازی داده‌ها**: بعد از پرداخت موفق، پاک کردن اطلاعات سفارش
- **مدیریت لغو**: حفظ داده‌ها در صورت لغو و بازگشت

### 5. نحوه تست:

1. **شروع از صفحه اصلی**:
   - کلیک روی "خرید نقدی" یا "خرید نسیه"
   - انتقال به صفحه Shopping

2. **انتخاب محصولات**:
   - انتخاب محصولات مختلف
   - تعیین تعداد
   - مشاهده خلاصه سفارش

3. **ادامه خرید**:
   - کلیک روی "ادامه خرید"
   - انتقال به صفحه Payment

4. **درگاه پرداخت**:
   - مشاهده اطلاعات سفارش
   - انتخاب روش پرداخت
   - پر کردن فرم
   - پرداخت یا لغو

### 6. فایل‌های تغییر یافته:

- `Shopping/shopping.js`: تابع `proceedToCheckout()`
- `Shopping/shopping.html`: اضافه کردن persian-numbers.js
- `Payment/payment.js`: بارگذاری و نمایش داده‌ها
- `Index/script.js`: هدایت به صفحه Shopping

### 7. وابستگی‌ها:
- فونت Vazirmatn
- persian-numbers.js برای نمایش اعداد فارسی
- Session Storage برای انتقال داده‌ها

## نکات مهم:
- همه قیمت‌ها به صورت فارسی نمایش داده می‌شوند
- طراحی کاملاً Responsive است
- امکان بازگشت در هر مرحله وجود دارد
- داده‌های سفارش بعد از پرداخت پاک می‌شوند 